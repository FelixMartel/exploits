# wkhtmltopdf exploit
See [blog post](https://blog.lixtelnis.com/wkhtmltopdf-webkit/). Goal is to be portable across x64 linux builds.
Overview:
- Simple addrof primitive
- Free primitive allows aliasing of Uint8Array and next object allocation
- Aliasing of a StringImpl for arbitrary memory read (workaround since can't alias with Uint8Array at this point)
- Use arbitrary read to obtain the vtable pointer Uint8Array
- Aliasing of Array to craft a fake Uint8Array using vtable value. We have gained an arbitrary write (not used)
- Fake js function object and patch first vtable offset used when calling `fajeobj()`. Replace it with QProcess::startDetached
- rdi (this) will point to an hybrid/incomplete QString and js function we craft. This works because the fields of both structures do not interfere

## credits
- [Object aliasing primtive](https://scarybeastsecurity.blogspot.com/2017/05/ode-to-use-after-free-one-vulnerable.html) from Chris Evans
- whoever found CVE-2012-3748